---
title: "低延时(ULL)交易系统开发框架"
author: William
date: 2019-12-20
lastmod: 2019-12-20
categories: [shared]
tags: [高频交易,低延时,交易系统]
description: 转自一个国外低延时高频交易系统开发课程的大纲。
draft: false
ToC: true
---

> [ULL (ULTRA LOW LATENCY) ARCHITECTURES FOR ELECTRONIC TRADING](https://homerunfitness.wordpress.com/2019/09/01/ull-ultra-low-latency-architectures-for-electronic-trading-sep-18-nov-7-2019-global-online-nyu-adjunct-instructor-ted-hruzd/)

**ULL (Ultra Low Latency) Architectures for Electronic Trading**
*NYU SPS – **Online**, Adjunct Instructor: Ted Hruzd* 
**FALL 2019 GLOBAL ON-LINE SEP 18 – NOV7**

8 weeks with 4 modules, 5 assignments 90 minute optional weekly Google hangout sessions plus collaboration with WhatsApp with my responses within 24 hours

On-Line Registration – https://www.sps.nyu.edu/professional-pathways/topics/finance/asset-management-and-investment-strategies/FINA1-CE9515-ull-ultra-low-latency-architectures-for-electronic-trading.html

*** All course content will be online by Sep 16 for Sep 18 start.  WhatsApp will be set up also so we can all communicate / collaborate / discuss assignments / etc …  Then an optional 90 minute Google Hangouts session will be setup Saturday morning New York Time likely 9 am – 10:30 am

## Course Objectives

Develop advanced skills in architecting electronic trading (ET) and market data applications for ultra low latency (ULL), for competitive advantage, and for positive ROI.  At end of course, one will have developed expertise in end-end architecture of ET applications and infrastructure, including:

- roles of FPGA’s, GPU’s, over-clocked servers, and high end Intel Cascade Lake servers and AM EPYC Rome servers
- Linux kernel and NIC kernel bypass tuning,
- options available for architecting ULL networks from infrastructure and application perspectives
- network performance analysis via WireShark and Corvil (hands-on tech expertise via remote access to a simulate trading app)
- Machine Learning (ML), AI, Neural Networks including LSTM (Long Short Term Memory) Recurrent Neural Networks via Python / Tensor Flow, Decision Trees, Random Forests, Anomaly Detection Engines, Reinforcement Learning Engines, Pattern Recognition, Classification Models with R – Studio and ML models include alpha seeking, smart order routing, fill rate predictions. Even if you have little or no experience in developing ML, you will learn subsets of R and Python to develop your own upon course completion
- Intro to Block Chain, exploring how to scales Block Chain for financial apps

 

### MODULE-1

**MODULE-1: Hardware/Application Accelerated Architectures**

- Tick-2-Trade applications with single digit micro seconds, even with sub 1 micro seconds
- How to architect for deterministic latencies even in times of volume spikes
- Why ‘Meta-Speed’ (info how to used speed) is more important than pure speed
- Proper use of multi-layer ULL switches, FPGA’s, GPU’s, MicroWave wireless RF network technologies & over-clocked servers
- Options available with FPGA’s integrated in multi-layer ULL switches (ex: Market Data normalization & Book Builds)
- Assess advantages among the leading FPGA vendors Intel/Altera and Xilinx
  - Examine each for both trading & analytics
  - Assess each vendor’s capabilities for FPGA applications based on OpenCL, C++ using FPGA libraries
  - Learn best practices in FPGA architectures for market data, order routing, Machine Learning & AI
  - Learn Engine 2/from memory optimizations on FPGA’s
- NVIDIA DGX-2 GPU processors role for precision analytics
- Compare FPGA’s vs GPU’s for ML Deep Learning
- Explore relevancy to ULL ET and ML of new “Processor in Memory” or PIM architectures from Intel and NVIDIA (speed up data ingestion to CPU & GPU processing cycles)
- Alternate role Data Direct Networks (DDN) for above data/processing speedups for HPC, HFT, AI
- Market Data Feed Handlers in FPGA; Order Books in Intel Cores or FPGA’s – achieve 20 x’s parallelization for full depth books?
- Integration of FPGA’s and Intel cores via high speed caches, FPGA’s and cores on same die (Intel-Altera and Xilinx — current and upcoming enhancements)
- FIX engines in FPGA based NIC’s and appliances
- Multi core, high speed cache Intel based servers + Intel’s new MESH socket interconnects for ULL and deterministic memory I/O
- Leading FPGA based NIC(s) – from SolarFlare, Mellanox, ExaBlaze, Enyx
- SolarFlare Direct TCP
- Layer 1 and multi layer network switches (Arista/Metamako, ExaBlaze)
- Fundamentals of FPGA design and programming
- OpenCL and C++ for ULL programming best practices & FPGA programming
- Intel’s optimizing C++ with deep vectors AVX-512, Thread Building blocks (TBB), and Intel’s new AVX 512 VNNI for Neural Network speedups
- Intel C++ best practice design pattern of internally vectorize code inside a loop or interaction, and externally parallelize the code vi pragma’s and specific code
- How to optimize app code performance with hardware server config (NUMA)
- Prospects for Application Specific Integrated Circuits (ASICs) supplanting FPGA’s in 1-3 years for most latency sensitive applications
- Best Practices for Market Makers & High Freq Traders (HFT)

- - Automated ULL software
  - Wide range of markets
  - Role of ML & AI
  - Direct Market Access (DMA) architectures
  - Risk Mgt
  - Colo Configurtions
  - Resiliency & High Availability, DR
  - High Performance Compute Clusters
  - News Sentiment Analytics

- Python development of basic Algo strategies & software design/analysis for back testing Algo’s
- Intel’s new “HPAT” Python compiler with directives to parallelize Python code
- Hot right now – Chronicle: a Java based microservices framework touting superior mem mgt + horizontal scalability for FIX Engines and more
- Intro to BlockChain – can common interests least to technology to benefit all & cut costs, speed up settlements – LL settlements, enhance TCA?
  - What electronic trading applications can integrate with BlockChain?
  - How to architect such applications
- ROI analysis

**HOMEWORK:**

Ted will present 3 Visio ULL architectures of end-end trading systems and ask class to critique all infrastructure components individually and in the aggregate, along with 1st steps to start ROI analysis.  In addition, students will be required to enhance the architecture they chose as the “best”

 

### MODULE-2

**MODULE-2: Linux kernel tuning + NIC kernel bypass technologies and configurations**

- Detail benefits of Red Hat Linux Network-Latency profile (ex favors performance over power savings)
- Linux 7.3/4/5/6 and Linux 8 kernel and NIC tuning for kernel bypass –
- Identify niche kernel tuning for extremely high message processing
- Kernel bypass technologies including RDMA and LDMA
- Infiniband (IB) and RDMA over Ethernet (RoCE) protocols for ULL
- Identify additional tuning for ultimate ULL kernel and micro services frameworks
- How to validate tuned OS via load tests and commands such as sysctl -a
- SolarFlare (SF) latency benefits of Open OnLoad kernel bypass and how to further configure/ tune subsequent to analysis via sfnettest, sfjitter, SF Dump, jhickup, and performance load tests
- SF ef_vi, TCP Direct and role on “raw” Tick-2-Trade (T2T) times of under 100 ns via OnLoad + LDA-Tech LightFleet FPGA appliance + Penguine servers (STAC T0 benchmark) and other potential options
- Mellanox VMA kernel bypass, 40Gig E NICs, up to 100 Gig switches, how to integrate with IB and Exegy Market Data appliance

**HOMEWORK:**

Ted will pose several technical questions pertaining to kernel tuning and bypass for class to answer.

### MODULE-3

**MODULE-3: Machine Leaning (ML) & Artificial Intelligence (AI) for both ULL Electronic Trading, Wealth Mgt, and BlockChain applications**

- Math behind multiple ML models, with deep dive into Neural Networks (NN), especially LSTM Recurrent NN, Auto Encoding NN for Anomaly Detection Engines
  - Will learn the subset of Python & Tensor Flow code to create a RNN that predicts future stock prices, fill rates, and even trading revenue; then integrate a Decision Tree model in R utilizing same input data to identify what factors may be “tuned” to render more accurate projections; also we will learn how to use the ML insights to identify options to improve fill rates / increase revenues
  - Explore how Reinforcement Learning ML can integrate with near real time NN for competitive advantages via ULL insights to alpha, risk, routes (SOR), TCA, compliance)
- ML / NN for seeking alpha via basic R programming + specific ML libraries
- Supervised vs unsupervised ML
- Synergies with Data Mining
- Optimal Architectures for ML: Infrastructure, Software
- Role of SME in ML & AI
- Determining what model to choose
- How to interpret results
- How to verify models
- Tensor Flow for parallelization of ML models
- How to tune, tweak models for greater accuracy and predictive value
- ML and Event Stream processing, real time analytics for seeking alpha (trade opportunities)
- Definition of Deep Learning (DL)
- DL Models and use cases
- Define AI; provide use cases
- ML and DL as inputs to AI
- Time-2-Market & ROI projections for ML / AI initiatives end-2-end
- Best Practices in AI in our industry
- Options to integrate ML/AI alpha seeking capabilities in CoLo environments

- - How to decrease Total Cost of Ownership (TCO) in CoLo architectures

- In Class (Hands-On)
  - RStudio & H20
  - Portfolio analysis via Classification Model using R/H20
  - Predictive analysis of new trading strategies via Decision Trees (R or Python)
  - Pattern Recognition of Trading Patterns to provide am Alpha service for Buy-Side
- Blockchain – more depth than Module 1
- Blockchain scaling limitations
- Assess CFTC BlockChain plans for near real time clearing (then extend the BlockChain for low volume trading, ultimately to higher volume trading of commodities, derivatives, options)
- How to integrate real time ML and AI with BlockChain architectures
- Learn a rapidly pervasive BlockChain related protocol “Smart Contracts” that may largely solve BlockChain scaling limittions
- Assess Ant Financial Wealth Mgt BlockChain plans (examine its use of Smart Contracts)

**HOMEWORK:**

- Ted will provide several “how-to” docs with all code / procedures to run to create multiple ML models. Students will run at least 1 of these models and respond with what predictive insights they provide.  ** NO Coding will be required.  But there will be one simple ML model where one will have option to alter or add code to improve accuracy or provide more meaningful insights (extra credit)

 

### MODULE-4

**MODULE-4: Architecting ULL Networks + how to diagnose/resolve network problems vi Corvil and Wireshark**

- ULL network configuration best practices
- Spine-Leaf architectures
- Multicast best practices
- Examine ULL Multicast architectures available from lightfleet.com; determine applicability for ULL networks and how to project resulting performance (latency) improvements
- Network protocols including TCP, UD, BRP, OSPF, LLDP
- Remote access to a Corvil appliance for deep dive in network and transaction diagnostics
- How to utilize Corvil decoders for FIX protocol, LBM messaging, and market data feeds
- Wireshark – to supplement Corvil analytics with deep dive network diagnostics to identify RCA of latencies
- Best practices in architecting Corvil’s new App Agent software for software processing insights
- ULL messaging middleware (29 West LBM/UME) and 60 East Tech AMPS
- PTP architectures for large market data / trading application infrastructures
- Network appliances – detailed timings/analytics – network, market data, and order routing – Corvil, Instrumentix, SolarCapture
- ULL Networks, including options for integrating multi-layer switches, FPGA appliances, new approaches to ULL multi-cast market data distribution
- ULL storage networks, including NVMeOF fabrics, Intel Optane, 3D XPoint, EverSpin new MRAM deterministic memory + persistent storage options. Special focus on DDN and Pure Storage
- How ULL deterministic memory can lower end-2-end latencies for subset of application flows, especially those based on ULL analytics
- Correlation of ULL networks and fill rates
- Tools (some free, several with RH Linux) to attain network performance optimization insights

HOMEWORK

- Specific hands on Corvil exercises for class to evaluate results and propose mitigation of network problems and strategic redesigns
- 

**FINAL ASSIGNMENT: Architect and End-2-End ULL Eectroinic Trading App integrated with ULL ML/AI for Alpha, Risk, Routing (SOR), TCA, Complaince**

- Ted will detail requirements by Oct 23, with 2 weeks to complete

 

**PreReq – (for most, expecting basic to intermediate expertise, unless noted)**

- Most important: at least 2 years working with electronic trading applications/infrastructures as Developer, SA, network admin/engineer, Architect, QA analyst, tech project mgr, operations engineer, manager, CTO, CIO, CEO, vendor or consultant providing technology to Wall Street IT,
- TCP/IP, UDP, multicast (basic knowledge),
- Linux OS and shell or scripting (ex bash, perl); at minimum basic familiarity of output and usefulness of core Linux commands such as sysctl –a, ethtool, ifconfig, top, ls, grep, awk, sed, and others listed later in this syllabus
- Intel servers, cores, sockets, GHz clock speed, NUMA
- Network routers, switches
- 1 or more network protocols from BGP, OSPF, EIGRP, MPLS, IB
- FIX protocol
- Market Data, at minimum contents of equities consolidated feeds
- Visio (will use for homework assignments; HOWEVER – to save time I will accept ‘pictures’ of white board architectures / designs)
- R programming (nice to have. Will use basics that one can learn in 1-2 hours), then extend upon that in classes for class hands-on Machine Learning
- Python (very basic will be fine – a 2 hour reading assignment will be arranged for beginners). We will use a text written for traders with zero programming experience that quickly trains them how to use small set of Python for creating trading algo’s

## Course Logistics

- No Tech book(s) to download to kindle. Instead several tech docs and many tech links will be provided.  Most significant doc for all 4 Modules in a PPT per module
- Multiple web site links to technical white papers and tech analyses (ex [com](http://www.nextplatform.com/), http://intelligenttradingtechnology.com/, [http://datamanagementreview.com](http://datamanagementreview.com/), [www.tabbforum.com](http://www.tabbforum.com/),  [www.tradersmagazine.com](http://www.tradersmagazine.com/)
- Visio OR simply draw on whiteboards, send pictures (some homework assignments)